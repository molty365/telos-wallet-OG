(globalThis["webpackChunktelos_web_wallet"]=globalThis["webpackChunktelos_web_wallet"]||[]).push([[783],{45783:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>We});var o=a(59835),n=a(86970),t=a(60499),s=a(27712),c=a(24352);const r={class:"c-allowances-page-controls__row-1 q-mb-lg"},u={class:"c-allowances-page-controls__buttons"},d=(0,o.aZ)({__name:"AllowancesPageControls",props:{enableRevokeButton:{type:Boolean},loading:{type:Boolean}},emits:["refresh","revoke-selected","search-updated","include-cancelled-updated"],setup(e,{emit:l}){const{t:a}=(0,s.QT)(),c=(0,t.iH)(""),d=(0,t.iH)(!1);(0,o.Fl)((()=>a(`evm_allowances.${d.value?"includes":"excludes"}_cancelled_allowances`)));function i(){l("revoke-selected")}function w(){l("refresh")}return(s,d)=>{const g=(0,o.up)("q-icon"),m=(0,o.up)("q-input"),v=(0,o.up)("q-btn");(0,o.up)("q-toggle");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",r,[(0,o.Wm)(m,{modelValue:c.value,"onUpdate:modelValue":[d[0]||(d[0]=e=>c.value=e),d[1]||(d[1]=e=>l("search-updated",e))],outlined:"",label:(0,t.SU)(a)("evm_allowances.search_label"),class:"c-allowances-page-controls__search-input"},{append:(0,o.w5)((()=>[(0,o.Wm)(g,{name:"search"})])),_:1},8,["modelValue","label"]),(0,o._)("div",u,[(0,o.Wm)(v,{disable:!e.enableRevokeButton,color:"primary",class:"c-allowances-page-controls__buttons-btn",onClick:i},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(a)("evm_allowances.revoke_selected")),1)])),_:1},8,["disable"]),(0,o.Wm)(v,{color:"primary",class:"c-allowances-page-controls__buttons-btn",icon:"refresh",disable:e.loading,loading:e.loading,onClick:w},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(a)("evm_allowances.refresh")),1)])),_:1},8,["disable","loading"])])]),(0,o.kq)("",!0)],64)}}});var i=a(66611),w=a(22857),g=a(68879),m=a(23175),v=a(69984),p=a.n(v);const _=d,b=_;p()(d,"components",{QInput:i.Z,QIcon:w.Z,QBtn:g.Z,QToggle:m.Z});var k=a(61957),M=a(61836),S=a(84193),N=a(79428),y=a(22285),f=a(84746),A=a(81150),I=a(43446),U=a(16894),C=a(49746),T=a(44886);const h=(0,o.aZ)({__name:"NftCollectionStack",props:{collection:null},setup(e){const l=e,a=(0,S.useNftsStore)(),n=(0,t.iH)(null),s=(0,t.iH)(!0),c=(0,t.iH)([]),r=(0,o.Fl)((()=>c.value.slice(0,3)));return(0,o.YP)(r,(()=>{n.value&&n.value.style.setProperty("--stack-width",8*r.value.length+16+"px")})),(0,o.bv)((async()=>{c.value=await a.fetchNftsFromCollection(S.CURRENT_CONTEXT,l.collection)??[],s.value=!1})),(e,l)=>{const a=(0,o.up)("q-skeleton");return(0,o.wg)(),(0,o.iD)("div",{ref_key:"root",ref:n,class:"nft-collection-stack"},[s.value?((0,o.wg)(),(0,o.j4)(a,{key:0,type:"rect",height:"24px",width:"24px"})):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,t.SU)(r),(e=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(T.Z,{key:e.key,nft:e,"preview-mode":!1,"tile-mode":!1,"icon-size":24,class:"nft-collection-stack__nft"},null,8,["nft"])),[[k.F8,!s.value]]))),128))],512)}}});var D=a(57133);const j=h,z=j;p()(h,"components",{QSkeleton:D.ZP});var x=a(99619),Z=a(77735),Q=a(92338),W=a(17779);const E={class:"c-edit-allowance-modal__options-container"},F=(0,o._)("br",null,null,-1),L={class:"o-text--paragraph-bold"},B=(0,o._)("br",null,null,-1),P=(0,o._)("br",null,null,-1),H=(0,o._)("br",null,null,-1),O=(0,o._)("br",null,null,-1),Y=(0,o._)("br",null,null,-1),R=(0,o._)("br",null,null,-1),$=(0,o._)("br",null,null,-1),V=(0,o._)("br",null,null,-1);var q,J;(function(e){e["none"]="none",e["unlimited"]="unlimited",e["custom"]="custom"})(q||(q={})),function(e){e["allowed"]="allowed",e["not_allowed"]="not_allowed"}(J||(J={}));const K=(0,o.aZ)({__name:"EditAllowanceModal",props:{row:null,showDialog:{type:Boolean}},emits:["close"],setup(e,{emit:l}){const a=e,{t:c}=(0,s.QT)(),r=(0,S.getAntelope)(),u=(0,S.useChainStore)().currentChain.settings.getExplorerUrl(),{fiatLocale:d}=(0,S.useUserStore)(),i=(0,t.iH)(q.none),w=(0,t.iH)(J.allowed),g=(0,t.iH)(f.O$.from(0)),m=(0,t.iH)(!1),v=(0,t.iH)(f.O$.from(0)),p=(0,o.Fl)((()=>(0,M.Km)(a.row))),_=(0,o.Fl)((()=>(0,M.Ji)(a.row))),b=(0,o.Fl)((()=>a.row)),k=(0,o.Fl)((()=>a.row)),N=(0,o.Fl)((()=>a.row)),y=(0,o.Fl)((()=>{const{spenderAddress:e}=a.row,l=(0,S.useChainStore)().currentChain.settings.getExplorerUrl();return`${l}/address/${e}`})),I=(0,o.Fl)((()=>p.value?c("global.token"):_.value?c("global.collectible"):c("global.collection"))),U=(0,o.Fl)((()=>{if(p.value)return`${b.value.tokenName} (${b.value.tokenSymbol})`;const e=a.row,l=e.collectionName||e.collectionAddress;return _.value?`${l} #${k.value.tokenId}`:`${l} (${c("evm_allowances.entire_collection")})`})),C=(0,o.Fl)((()=>p.value?!g.value.eq(b.value.allowance)&&g.value.lte(M.rb):m.value!==N.value.allowed)),T=(0,o.Fl)((()=>(0,S.useFeedbackStore)().isLoading("updateErc20Allowance")||(0,S.useFeedbackStore)().isLoading("updateSingleErc721Allowance")||(0,S.useFeedbackStore)().isLoading("updateNftCollectionAllowance"))),h=(0,o.Fl)((()=>(0,S.useAccountStore)().currentAccount.account));async function D(){let e,o;if(!await(0,S.useAccountStore)().assertNetworkConnection(S.CURRENT_CONTEXT))return;if(p.value)e=await(0,S.useAllowancesStore)().updateErc20Allowance(h.value,a.row.spenderAddress,b.value.tokenAddress,g.value),o=c("notification.neutral_message_updating_erc20_allowance",{symbol:b.value.tokenSymbol,spender:a.row.spenderName||(0,A.FP)(a.row.spenderAddress)});else if(_.value){e=await(0,S.useAllowancesStore)().updateSingleErc721Allowance(h.value,a.row.spenderAddress,k.value.collectionAddress,k.value.tokenId,m.value);const l=`${k.value.collectionName||(0,A.FP)(k.value.collectionAddress)} #${k.value.tokenId}`;o=c("notification.neutral_message_updating_nft_allowance",{tokenText:l,operator:a.row.spenderName||(0,A.FP)(a.row.spenderAddress)})}else{e=await(0,S.useAllowancesStore)().updateNftCollectionAllowance(h.value,a.row.spenderAddress,N.value.collectionAddress,m.value);const l=N.value.collectionName||(0,A.FP)(N.value.collectionAddress);o=c("notification.neutral_message_updating_nft_allowance",{tokenText:l,operator:a.row.spenderName||(0,A.FP)(a.row.spenderAddress)})}const n=r.config.notifyNeutralMessageHandler(o);e.wait().then((()=>{r.config.notifySuccessfulTrxHandler(`${u}/tx/${e.hash}`)})).catch((e=>{r.config.notifyErrorHandler(e),W.error(e)})).finally((()=>{l("close"),n()}))}return(0,o.YP)(i,(e=>{e===q.none?g.value=f.O$.from(0):e===q.unlimited?g.value=M.rb:g.value=v.value})),(0,o.YP)(w,(e=>{m.value=e===J.allowed})),(0,o.YP)(v,(e=>{g.value=e})),(0,o.wF)((()=>{if(p.value){const e=b.value.allowance;e.isZero()?i.value=q.none:e.gt(b.value.tokenMaxSupply)?i.value=q.unlimited:(v.value=b.value.allowance,i.value=q.custom),g.value=e}else w.value=N.value.allowed?J.allowed:J.not_allowed,m.value=N.value.allowed})),(a,s)=>{const r=(0,o.up)("q-card-section"),u=(0,o.up)("q-radio"),g=(0,o.up)("q-btn"),m=(0,o.up)("q-card-actions"),k=(0,o.up)("q-card"),M=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(M,{"model-value":e.showDialog,"onUpdate:modelValue":s[7]||(s[7]=()=>l("close"))},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{class:"c-edit-allowance-modal__card q-pa-md shadow-3"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(c)("evm_allowances.edit_modal_description"))+" ",1),(0,o.Wm)(x.Z,{text:e.row.spenderName||e.row.spenderAddress,url:(0,t.SU)(y)},null,8,["text","url"])])),_:1}),(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o._)("div",E,[(0,o.Uk)((0,n.zw)((0,t.SU)(I))+" ",1),F,(0,o._)("span",L,(0,n.zw)((0,t.SU)(U)),1),B,(0,t.SU)(_)?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[P,(0,o.Uk)(" "+(0,n.zw)((0,t.SU)(c)("evm_allowances.erc_721_single_allowance_blurb"))+" ",1),H],64)):(0,o.kq)("",!0),O,(0,o.Uk)(" "+(0,n.zw)((0,t.SU)(c)("global.allowance"))+" ",1),Y,(0,t.SU)(p)?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(u,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=e=>i.value=e),val:q.none,label:(0,t.SU)(c)("global.none")},null,8,["modelValue","val","label"]),R,(0,o.Wm)(u,{modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),val:q.unlimited,label:(0,t.SU)(c)("global.unlimited")},null,8,["modelValue","val","label"]),$,(0,o.Wm)(u,{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=e=>i.value=e),val:q.custom,label:(0,t.SU)(c)("global.custom")},null,8,["modelValue","val","label"]),(0,o.Wm)(Q.Z,{modelValue:v.value,"onUpdate:modelValue":s[3]||(s[3]=e=>v.value=e),symbol:(0,t.SU)(b).tokenSymbol,decimals:(0,t.SU)(b).tokenDecimals,"decimals-to-display":(0,t.SU)(b).tokenDecimals,locale:(0,t.SU)(d),label:(0,t.SU)(c)("evm_allowances.token_amount_input_label"),disabled:i.value!==q.custom,name:"custom-erc20-allowance-input",class:"c-edit-allowance-modal__currency-input"},null,8,["modelValue","symbol","decimals","decimals-to-display","locale","label","disabled"])],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:2},[(0,o.Wm)(u,{modelValue:w.value,"onUpdate:modelValue":s[4]||(s[4]=e=>w.value=e),val:J.not_allowed,label:(0,t.SU)(c)("global.not_allowed")},null,8,["modelValue","val","label"]),V,(0,o.Wm)(u,{modelValue:w.value,"onUpdate:modelValue":s[5]||(s[5]=e=>w.value=e),val:J.allowed,label:(0,t.SU)(c)("global.allowed")},null,8,["modelValue","val","label"])],64))])])),_:1}),(0,o.Wm)(m,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{label:(0,t.SU)(c)("global.cancel"),flat:"",color:"primary",onClick:s[6]||(s[6]=()=>l("close"))},null,8,["label"]),(0,o.Wm)(g,{loading:(0,t.SU)(T),disable:!(0,t.SU)(C),label:(0,t.SU)(c)("global.confirm"),color:"primary",onClick:D},null,8,["loading","disable","label"])])),_:1})])),_:1})])),_:1},8,["model-value"])}}});var X=a(87743),G=a(44458),ee=a(63190),le=a(11480),ae=a(11821);const oe=K,ne=oe;p()(K,"components",{QDialog:X.Z,QCard:G.Z,QCardSection:ee.Z,QRadio:le.Z,QCardActions:ae.Z,QBtn:g.Z});const te={class:"flex items-center"},se={class:"c-allowances-table-row__flex-td"},ce=["src","alt"],re={class:"o-text--paragraph-bold u-text--default-contrast"},ue={class:"c-allowances-table-row__flex-td"},de=(0,o.aZ)({__name:"AllowancesTableRow",props:{row:null,revokeChecked:{type:Boolean}},emits:["revoke-toggled"],setup(e,{emit:l}){const c=e,r=a(52915),{t:u}=(0,s.QT)(),d=(0,S.useNftsStore)(),i=(0,S.useChainStore)().currentChain.settings,{fiatLocale:w,fiatCurrency:g}=(0,S.useUserStore)(),m=(0,M.Km)(c.row),v=(0,M.Ji)(c.row),p=((0,M.am)(c.row),(0,t.iH)(null)),_=(0,t.iH)(!1),b=(0,o.Fl)((()=>c.row)),h=(0,o.Fl)((()=>c.row)),D=(0,o.Fl)((()=>c.row)),j=(0,o.Fl)((()=>{let e;if(v)e="1 ".concat((0,A.aF)(c.row.tokenName,12));else if(m){const{balance:l,tokenSymbol:a,tokenDecimals:o}=c.row;e=(0,N.kg)(l,4,w,!0,a,!1,o,!0)}else{const{balance:l,collectionName:a,collectionAddress:o}=c.row,n=a?(0,A.aF)(a,12):(0,A.FP)(o);e=(0,N.kg)(l,0,w,!1,n,!1,0)}return e})),Q=(0,o.Fl)((()=>{let e;if(v)e=`1 ${c.row.tokenName} (${c.row.collectionName??(0,A.FP)(c.row.collectionAddress)} #${c.row.tokenId})`;else if(m){const{balance:l,tokenSymbol:a,tokenDecimals:o}=c.row;e=(0,N.kg)(l,I.Rs,w,!1,a,!1,o,!0)}else{const{balance:l,collectionName:a,collectionAddress:o}=c.row,n=a??o;e=(0,N.kg)(l,0,w,!1,n,!1,0,!1)}return u("evm_allowances.you_own",{asset:e})})),W=(0,o.Fl)((()=>{if(!m||!c.row.tokenPrice)return"";const e=Number((0,y.formatUnits)(c.row.balance,c.row.tokenDecimals)),l=e*c.row.tokenPrice;return(0,N.kg)(l,2,w,!0,g)})),E=(0,o.Fl)((()=>{if(!m||!c.row.tokenPrice)return"";const e=Number((0,y.formatUnits)(c.row.balance,c.row.tokenDecimals)),l=e*c.row.tokenPrice;return`1 ${c.row.tokenSymbol} = ${(0,N.kg)(l,2,w,!1,g)}`})),F=(0,o.Fl)((()=>{if(m){const e=c.row.allowance;if(e.eq(0))return u("global.none");const l=Number((0,y.formatUnits)(e,c.row.tokenDecimals));return e.gt(c.row.tokenMaxSupply)?u("global.unlimited"):l<M.gd&&l>0?u("global.less_than",{amount:M.gd}):(0,N.kg)(l,2,w,!0)}return c.row.allowed?u("global.allowed"):u("global.not_allowed")})),L=(0,o.Fl)((()=>{if(m){const e=c.row.allowance??f.O$.from(0);return(0,N.kg)(e,I.Rs,w,!1,c.row.tokenSymbol,!1,c.row.tokenDecimals,!0)}return c.row.allowed?u("global.allowed"):u("global.not_allowed")})),B=(0,o.Fl)((()=>`${i.getExplorerUrl()}/address/${c.row.spenderAddress}`)),P=(0,o.Fl)((()=>u(m?"global.token":"nft.collectible"))),H=(0,o.Fl)((()=>{const e=Date.now()/1e3,l=c.row.lastUpdated/1e3,a=e-l,o=(0,U.Ht)(a,(e=>u(`antelope.words.${e}`)),!0);return u("global.time_ago",{time:o})})),O=(0,o.Fl)((()=>(0,U.L0)(c.row.lastUpdated/1e3,U.K_,!0))),Y=(0,o.Fl)((()=>{const{spenderName:e,spenderAddress:l}=c.row,a=e||(0,A.FP)(l),o=(0,M.Km)(c.row)?c.row.tokenSymbol:c.row.collectionName??(0,A.FP)(c.row.collectionAddress);return u("evm_allowances.revoke_checkbox_aria_label",{spender:a,token:o})})),R=(0,o.Fl)((()=>{const{spenderName:e,spenderAddress:l}=c.row,a=e||(0,A.FP)(l),o=(0,M.Km)(c.row)?c.row.tokenSymbol:c.row.collectionName??(0,A.FP)(c.row.collectionAddress);return u("evm_allowances.edit_allowance_aria_label",{spender:a,token:o})}));return(0,o.bv)((async()=>{if(v){const{collectionAddress:e,tokenId:l}=h.value;p.value=await d.fetchNftDetails(S.CURRENT_CONTEXT,e,l,"ERC721")}})),(l,a)=>{const s=(0,o.up)("q-checkbox"),c=(0,o.up)("q-td"),d=(0,o.up)("q-icon"),i=(0,o.up)("q-tr");return(0,o.wg)(),(0,o.j4)(i,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{key:"revoke"},{default:(0,o.w5)((()=>[(0,o._)("div",te,[(0,o.Wm)(s,{"model-value":e.revokeChecked,size:"xs","aria-label":(0,t.SU)(Y),onClick:a[0]||(a[0]=()=>l.$emit("revoke-toggled")),onKeydown:a[1]||(a[1]=(0,k.D2)((0,k.iM)((()=>l.$emit("revoke-toggled")),["prevent"]),["enter","space"]))},null,8,["model-value","aria-label"])])])),_:1}),(0,o.Wm)(c,{key:"asset"},{default:(0,o.w5)((()=>[(0,o._)("div",se,[(0,t.SU)(m)?((0,o.wg)(),(0,o.iD)("img",{key:0,src:(0,t.SU)(b).tokenLogo??(0,t.SU)(r),alt:(0,t.SU)(u)("evm_allowances.asset_logo_alt",{symbol:(0,t.SU)(b).tokenSymbol}),height:"24",width:"24",class:(0,n.C_)({"c-allowances-table-row__asset-logo":!0,"c-allowances-table-row__asset-logo--gray":!(0,t.SU)(b).tokenLogo})},null,10,ce)):p.value&&(0,t.SU)(v)?((0,o.wg)(),(0,o.j4)(T.Z,{key:1,nft:p.value,"preview-mode":!1,"tile-mode":!1,"icon-size":24},null,8,["nft"])):((0,o.wg)(),(0,o.j4)(z,{key:2,collection:(0,t.SU)(D).collectionAddress},null,8,["collection"])),(0,o.Wm)(C.Z,{text:(0,t.SU)(Q),"hide-icon":!0},{default:(0,o.w5)((()=>[(0,o._)("span",re,(0,n.zw)((0,t.SU)(j)),1)])),_:1},8,["text"])])])),_:1}),(0,o.Wm)(c,{key:"value"},{default:(0,o.w5)((()=>[(0,t.SU)(W)?((0,o.wg)(),(0,o.j4)(C.Z,{key:0,text:(0,t.SU)(E),"hide-icon":!0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(W)),1)])),_:1},8,["text"])):((0,o.wg)(),(0,o.j4)(C.Z,{key:1,warnings:[(0,t.SU)(u)("evm_wallet.no_fiat_value")]},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(u)("global.not_applicable_short")),1)])),_:1},8,["warnings"]))])),_:1}),(0,o.Wm)(c,{key:"allowance"},{default:(0,o.w5)((()=>[(0,o._)("div",ue,[(0,o.Wm)(C.Z,{text:(0,t.SU)(L),"hide-icon":!0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(F)),1)])),_:1},8,["text"]),(0,o.Wm)(d,{"aria-label":(0,t.SU)(R),class:"c-allowances-table-row__edit-icon",name:"o_edit",size:"xs",color:"primary",tabindex:"0",onClick:a[2]||(a[2]=e=>_.value=!0),onKeydown:a[3]||(a[3]=(0,k.D2)((0,k.iM)((e=>_.value=!0),["prevent"]),["enter","space"]))},null,8,["aria-label"])]),(0,o.Wm)(ne,{row:e.row,showDialog:_.value,onClose:a[4]||(a[4]=e=>_.value=!1)},null,8,["row","showDialog"])])),_:1}),(0,o.Wm)(c,{key:"spender"},{default:(0,o.w5)((()=>[(0,o.Wm)(x.Z,{text:e.row.spenderName||e.row.spenderAddress,url:(0,t.SU)(B),purpose:(0,t.SU)(u)("evm_allowances.spender_link_label")},null,8,["text","url","purpose"])])),_:1}),(0,o.Wm)(c,{key:"type"},{default:(0,o.w5)((()=>[(0,o.Wm)(Z.Z,{label:(0,t.SU)(P)},null,8,["label"])])),_:1}),(0,o.Wm)(c,{key:"updated"},{default:(0,o.w5)((()=>[(0,o.Wm)(C.Z,{text:(0,t.SU)(O),"hide-icon":!0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)((0,t.SU)(H)),1)])),_:1},8,["text"])])),_:1})])),_:1})}}});var ie=a(31233),we=a(67220),ge=a(11221);const me=de,ve=me;p()(de,"components",{QTr:ie.Z,QTd:we.Z,QCheckbox:ge.Z,QIcon:w.Z});var pe=a(24189);const _e={key:0,class:"flex items-center"},be=["aria-label","onClick","onKeydown"],ke=(0,o.aZ)({__name:"AllowancesTable",props:{rows:null},emits:["sortChanged","selectedRowsChanged"],setup(e,{emit:l}){const a=e,{t:c}=(0,s.QT)(),{fiatLocale:r,fiatCurrency:u}=(0,S.useUserStore)(),d=(0,N.jK)(r,u),i=(0,t.iH)(!1),w=(0,t.iH)({page:1,rowsPerPage:10,rowsNumber:a.rows.length,sortBy:M.B6.asset,descending:!0}),g=(0,t.iH)({}),m=[{name:M.B6.revoke,field:M.B6.revoke,label:"",align:"left"},{name:M.B6.asset,field:M.B6.asset,label:c("global.asset"),align:"left"},{name:M.B6.value,field:M.B6.value,label:`${c("global.value")} (${d})`,align:"left"},{name:M.B6.allowance,field:M.B6.allowance,label:c("evm_allowances.allowance"),align:"left"},{name:M.B6.spender,field:M.B6.spender,label:c("evm_allowances.authorized_spender"),align:"left"},{name:M.B6.type,field:M.B6.type,label:c("global.type"),align:"left"},{name:M.B6.updated,field:M.B6.updated,label:c("global.last_updated"),align:"left"}],v=(0,o.Fl)((()=>{const{page:e,rowsPerPage:l}=w.value,o=1===e?0:(e-1)*l,n=o+l;return a.rows.slice(o,n)}));function p(e){const{descending:l,sortBy:a}=w.value,o=!l&&a===e||a!==e,{asset:n,value:t,allowance:s,spender:r,type:u}=M.B6;let d="";return d=c(e===n?"evm_allowances.column_description_asset":e===t?"evm_allowances.column_description_value":e===s?"evm_allowances.column_description_allowance":e===r?"evm_allowances.column_description_spender":e===u?"evm_allowances.column_description_asset_type":"evm_allowances.column_description_updated"),c(o?"global.sort_by_descending":"global.sort_by_ascending",{column:d})}function _(e){const l=(0,M.Km)(e),a=(0,M.Ji)(e),o=l?e.tokenAddress:e.collectionAddress,n=a?`-${e.tokenId}`:"";return`${e.spenderAddress}-${o}${n}`}function b(e){let a;e===w.value.sortBy?(w.value.descending=!w.value.descending,a=w.value.descending):(w.value.sortBy=e,w.value.descending=!0,a=!0),l("sortChanged",{descending:a,sortBy:e})}function y(){const{value:e}=i;Object.keys(g.value).forEach((l=>{g.value[l]=e}))}function f(e){const l=(0,M.Km)(e),a=(0,M.Ji)(e),o=l?e.tokenAddress:e.collectionAddress,n=a?`-${e.tokenId}`:"";return g.value[`${e.spenderAddress}-${o}${n}`]}function A(e){const l=(0,M.Km)(e),a=(0,M.Ji)(e),o=l?e.tokenAddress:e.collectionAddress;let n=`${e.spenderAddress}-${o}`;a&&(n+=`-${e.tokenId}`),g.value[n]=!g.value[n],g.value[n]||(i.value=!1),Object.values(g.value).every((e=>e))&&(i.value=!0)}return(0,o.YP)(v,(e=>{g.value=e.reduce(((e,l)=>{const a=(0,M.Km)(l),o=(0,M.Ji)(l),n=a?l.tokenAddress:l.collectionAddress,t=o?`-${l.tokenId}`:"";return e[`${l.spenderAddress}-${n}${t}`]=!1,e}),{}),i.value=!1,y(),w.value.rowsNumber=a.rows.length}),{immediate:!0}),(0,o.YP)(g,(()=>{l("selectedRowsChanged",g.value)}),{deep:!0}),(e,l)=>{const a=(0,o.up)("q-checkbox"),s=(0,o.up)("q-icon"),r=(0,o.up)("q-th"),u=(0,o.up)("q-tr"),d=(0,o.up)("q-table");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(d,{columns:m,rows:(0,t.SU)(v),pagination:w.value,"binary-state-sort":"","hide-pagination":"",flat:"",class:"q-mb-md"},{header:(0,o.w5)((e=>[(0,o.Wm)(u,{props:e},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(u=>((0,o.wg)(),(0,o.j4)(r,{key:u.name,props:e,class:"o-text--paragraph u-text--default-contrast"},{default:(0,o.w5)((()=>[u.name===(0,t.SU)(M.B6).revoke?((0,o.wg)(),(0,o.iD)("div",_e,[(0,o.Wm)(a,{modelValue:i.value,"onUpdate:modelValue":[l[0]||(l[0]=e=>i.value=e),y],"aria-label":(0,t.SU)(c)("evm_allowances.revoke_all_checkbox_aria_label"),size:"xs"},null,8,["modelValue","aria-label"])])):((0,o.wg)(),(0,o.iD)("div",{key:1,class:"c-allowances-table__th-container",tabindex:"0","aria-label":p(u.name),onClick:e=>b(u.name),onKeydown:(0,k.D2)((0,k.iM)((e=>b(u.name)),["prevent"]),["enter","space"])},[(0,o.Uk)((0,n.zw)(u.label)+" ",1),(0,o.Wm)(s,{class:(0,n.C_)({"c-allowances-table__sort-icon":!0,"c-allowances-table__sort-icon--active":w.value.sortBy===u.name,"c-allowances-table__sort-icon--descending":w.value.descending&&w.value.sortBy===u.name||w.value.sortBy!==u.name}),name:"arrow_upward"},null,8,["class"])],40,be))])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,o.w5)((e=>[((0,o.wg)(),(0,o.j4)(ve,{key:_(e.row),row:e.row,revokeChecked:f(e.row),onRevokeToggled:l=>A(e.row)},null,8,["row","revokeChecked","onRevokeToggled"]))])),_:1},8,["rows","pagination"]),(0,o.Wm)(pe.Z,{pagination:w.value,onPaginationUpdated:l[1]||(l[1]=e=>w.value=e)},null,8,["pagination"])],64)}}});var Me=a(31746),Se=a(21682);const Ne=ke,ye=Ne;p()(ke,"components",{QTable:Me.Z,QTr:ie.Z,QTh:Se.Z,QCheckbox:ge.Z,QIcon:w.Z});var fe=a(6004),Ae=a(77155),Ie=a(17779);const Ue={class:"u-text--high-contrast"},Ce={class:"c-allowances-page__body"},Te={key:1,class:"q-mt-lg"},he={key:2},De={class:"c-allowances-page__empty-title"},je={class:"o-text--header-5 flex items-center q-mb-md"},ze={class:"q-mb-md"},xe=(0,o.aZ)({__name:"AllowancesPage",setup(e){const{t:l}=(0,s.QT)(),a=(0,S.getAntelope)(),r=(0,S.useAllowancesStore)(),u=(0,S.useChainStore)().currentChain.settings,d=l("evm_allowances.aside_header"),i=[{text:l("evm_allowances.aside_content_fragment_1")},{text:l("evm_allowances.aside_content_fragment_2_bold"),bold:!0},{text:l("evm_allowances.aside_content_fragment_3")},{text:l("evm_allowances.aside_content_fragment_4_bold"),bold:!0},{text:l("evm_allowances.aside_content_fragment_5"),bold:!1}],w=(0,t.iH)(!0),g=(0,t.iH)(!1),m=(0,t.iH)({descending:!0,sortBy:Ae.B6.asset}),v=(0,t.iH)(""),p=(0,t.iH)(null),_=(0,t.iH)([]),k=(0,t.iH)(!1),M=(0,t.iH)(null),N=(0,t.iH)(!1),y=(0,t.iH)(0),f=(0,t.iH)(0),A=(0,o.Fl)((()=>(0,S.useAccountStore)().currentAccount.account)),I=(0,o.Fl)((()=>!w.value&&0===U.value.length)),U=(0,o.Fl)((()=>{const{asset:e,value:a,allowance:o,spender:n,type:t}=Ae.B6,{sortBy:s}=m.value,c=m.value.descending?Ae.PE.descending:Ae.PE.ascending,u=[S.CURRENT_CONTEXT,c,g.value];let d;return d=s===e?r.allowancesSortedByAssetQuantity(...u):s===a?r.allowancesSortedByAllowanceFiatValue(...u):s===o?r.allowancesSortedByAllowanceAmount(...u):s===n?r.allowancesSortedBySpender(...u):s===t?r.allowancesSortedByAssetType(...u):r.allowancesSortedByLastUpdated(...u),v.value&&(d=d.filter((e=>{const a=v.value.toLowerCase(),o=l("global.none").toLowerCase(),n=l("global.unlimited").toLowerCase(),t=l("global.allowed").toLowerCase(),s=l("global.not_allowed").toLowerCase(),c=(0,Ae.Km)(e);let r=!1,u=!1,d=!1;c?(r=e.tokenSymbol.toLowerCase().includes(a),u=e.tokenAddress.toLowerCase().includes(a),d=e.allowance.toString().includes(a)||"0"===e.allowance.toString()&&(o.includes(a)||s.includes(a))||e.allowance.gt(e.tokenMaxSupply)&&n.includes(a)||"0"!==e.allowance.toString()&&t.includes(a)):(r=(e.collectionName??"").toLowerCase().includes(a)||e.collectionAddress.toLowerCase().includes(a),u=e.collectionAddress.toLowerCase().includes(a),d=e.allowed&&t.includes(a)||!e.allowed&&(s.includes(a)||o.includes(a)));const i=e.spenderAddress.toLowerCase().includes(a)||(e.spenderName??"").toLowerCase().includes(a);return r||d||i||u}))),d})),C=(0,o.Fl)((()=>_.value.length>0)),T=()=>(w.value=!0,(0,S.useAllowancesStore)().fetchAllowancesForAccount(A.value).then((()=>{w.value=!1})));function h(e){v.value=e}function D(e){g.value=e}function j(e){m.value={descending:e.descending,sortBy:e.sortBy}}function z(e){const l=[];Object.keys(e).forEach((a=>{e[a]&&l.push(a)})),_.value=l}function x(){function e(e,l){e?.wait().then((l=>{a.config.notifySuccessfulTrxHandler(`${u.getExplorerUrl()}/tx/${e.hash}`)})).catch((e=>{Ie.error(e)})),y.value=l}f.value=_.value.length,k.value=!0,y.value=_.value.length;const{promise:l,cancelToken:n}=(0,S.useAllowancesStore)().batchRevokeAllowances(_.value,A.value,e);M.value=()=>{n.cancel(),k.value=!1},l.finally((()=>{N.value=!0,setTimeout((()=>{T().finally((()=>{N.value=!1,k.value=!1,(0,o.Y3)((()=>{M.value=null,y.value=0,f.value=0}))}))}),3e3)}))}return(0,o.YP)(A,(e=>{e&&T()}),{immediate:!0}),(0,o.Jd)((()=>{p.value&&clearTimeout(p.value)})),(e,a)=>{const s=(0,o.up)("q-skeleton"),r=(0,o.up)("q-spinner"),u=(0,o.up)("q-card-section"),g=(0,o.up)("q-btn"),m=(0,o.up)("q-card-actions"),v=(0,o.up)("q-card"),p=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(c.Z,null,{header:(0,o.w5)((()=>[(0,o._)("h1",Ue,(0,n.zw)((0,t.SU)(l)("nav.allowances")),1)])),default:(0,o.w5)((()=>[(0,o._)("div",Ce,[(0,o.Wm)(fe.Z,{header:(0,t.SU)(d),content:i,"center-on-desktop":(0,t.SU)(I),class:"q-mb-lg"},null,8,["header","center-on-desktop"]),(0,t.SU)(I)?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(b,{key:0,"enable-revoke-button":(0,t.SU)(C),loading:w.value,onSearchUpdated:h,onIncludeCancelledUpdated:D,onRevokeSelected:x,onRefresh:T},null,8,["enable-revoke-button","loading"])),w.value?((0,o.wg)(),(0,o.iD)("div",Te,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(10,(e=>(0,o.Wm)(s,{key:`allowance-loading-row-${e}`,class:"c-allowances-page__skeleton-row",type:"rect"}))),64))])):(0,t.SU)(I)?((0,o.wg)(),(0,o.iD)("div",he,[(0,o._)("h2",De,(0,n.zw)((0,t.SU)(l)("evm_allowances.no_allowances")),1)])):((0,o.wg)(),(0,o.j4)(ye,{key:3,rows:(0,t.SU)(U),onSortChanged:j,onSelectedRowsChanged:z},null,8,["rows"]))]),(0,o.Wm)(p,{modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value=e),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o._)("h5",je,[(0,o.Uk)((0,n.zw)((0,t.SU)(l)("evm_allowances.revoking_allowances_title",{total:f.value,remaining:y.value}))+" Â  ",1),(0,o.Wm)(r,{color:"primary"})]),(0,o._)("p",ze,(0,n.zw)((0,t.SU)(l)("evm_allowances.revoking_allowances_description")),1),(0,o._)("p",null,(0,n.zw)((0,t.SU)(l)("evm_allowances.revoking_allowances_cancel_note")),1)])),_:1}),(0,o.Wm)(m,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{loading:N.value,color:"primary",label:(0,t.SU)(l)("global.cancel"),onClick:a[0]||(a[0]=e=>M.value?.())},null,8,["loading","label"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}});var Ze=a(13902);const Qe=xe,We=Qe;p()(xe,"components",{QSkeleton:D.ZP,QDialog:X.Z,QCard:G.Z,QCardSection:ee.Z,QSpinner:Ze.Z,QCardActions:ae.Z,QBtn:g.Z})},52915:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDEiIGhlaWdodD0iNDEiIHZpZXdCb3g9IjAgMCA0MSA0MSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzNV8yMjkxKSI+CjxyZWN0IHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMzQ2NjggMC41KSIvPgo8cGF0aCBkPSJNMTkuNTQ2OSA0MC41QzMwLjMyMzIgNDAuNSAzOS4wNTkxIDMxLjc2NDEgMzkuMDU5MSAyMC45ODc4QzM5LjA1OTEgMTAuMjExNSAzMC4zMjMyIDEuNDc1NTkgMTkuNTQ2OSAxLjQ3NTU5QzguNzcwNTggMS40NzU1OSAwLjAzNDY2OCAxMC4yMTE1IDAuMDM0NjY4IDIwLjk4NzhDMC4wMzQ2NjggMzEuNzY0MSA4Ljc3MDU4IDQwLjUgMTkuNTQ2OSA0MC41WiIgZmlsbD0iIzA3MUE1RiIvPgo8cGF0aCBkPSJNMTkuNTQ2OSA0MC41QzMwLjMyMzEgNDAuNSAzOS4wNTkxIDMxLjc2NDEgMzkuMDU5MSAyMC45ODc4QzM5LjA1OTEgMTAuMjExNSAzMC4zMjMxIDEuNDc1NTkgMTkuNTQ2OSAxLjQ3NTU5QzguNzcwNTggMS40NzU1OSAwLjAzNDY2OCAxMC4yMTE1IDAuMDM0NjY4IDIwLjk4NzhDMC4wMzQ2NjggMzEuNzY0MSA4Ljc3MDU4IDQwLjUgMTkuNTQ2OSA0MC41WiIgZmlsbD0idXJsKCNwYWludDBfbGluZWFyXzEzNV8yMjkxKSIvPgo8cGF0aCBkPSJNMTkuNTQ2OSA0MC41QzMwLjMyMzIgNDAuNSAzOS4wNTkxIDMxLjc2NDEgMzkuMDU5MSAyMC45ODc4QzM5LjA1OTEgMTAuMjExNSAzMC4zMjMyIDEuNDc1NTkgMTkuNTQ2OSAxLjQ3NTU5QzguNzcwNTggMS40NzU1OSAwLjAzNDY2OCAxMC4yMTE1IDAuMDM0NjY4IDIwLjk4NzhDMC4wMzQ2NjggMzEuNzY0MSA4Ljc3MDU4IDQwLjUgMTkuNTQ2OSA0MC41WiIgc3Ryb2tlPSJ1cmwoI3BhaW50MV9saW5lYXJfMTM1XzIyOTEpIiBzdHJva2Utb3BhY2l0eT0iMC4xMiIgc3Ryb2tlLXdpZHRoPSIwLjQ5OTIxNSIvPgo8cGF0aCBkPSJNMjMuNDg3MSAxMS4yMjIyTDI2LjM5MzUgMTEuNDE0OUwyNS4yNjQ4IDE0LjM0OTlMMjUuMDkwNiAxNC44MDI5TDI1LjMzNTcgMTUuMjIxN0wyOS4yMDIzIDIxLjgyODVMMjguNTgyNSAyNC45Mzc3TDI1LjQzNDMgMjUuNTE0NkwyNC45MDAzIDI1LjYxMjVMMjQuNjg3NyAyNi4xMTJMMjQuMjU4IDI3LjEyMjFMMjAuODIyOCAyOS4zNTc2TDEzLjczNDMgMzEuMDYzNEwxMS42Njc0IDI0LjA3MTdMMTEuODg1OCAxOS45NzlMMTIuNTQ1NyAxOS4xMDE4TDEyLjg3MiAxOC42NjhMMTIuNjg5NyAxOC4xNTY2TDExLjYxNTIgMTUuMTQxN0wxMy45OTggMTMuMDUwM0wyMS42NTMgMTMuMDk1NEwyMi4xODQ2IDEzLjA5ODZMMjIuNDg3NyAxMi42NjE5TDIzLjQ4NzEgMTEuMjIyMloiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMi4wMTc4OCIvPgo8L2c+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfMTM1XzIyOTEiIHgxPSIwLjAzNDY2MzgiIHkxPSIyMC45ODc4IiB4Mj0iMzkuMDU5MSIgeTI9IjIwLjk4NzgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iI0FFNzNGQSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNBRTczRkEiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L2xpbmVhckdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MV9saW5lYXJfMTM1XzIyOTEiIHgxPSIzOS4zMTY1IiB5MT0iMjAuOTg3OCIgeDI9Ii0wLjIyMjc0OCIgeTI9IjIwLjk4NzgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iI0FFNzNGQSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNBRTczRkEiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L2xpbmVhckdyYWRpZW50Pgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzNV8yMjkxIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMzQ2NjggMC41KSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo="}}]);