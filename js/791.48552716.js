"use strict";(globalThis["webpackChunktelos_web_wallet"]=globalThis["webpackChunktelos_web_wallet"]||[]).push([[791],{13791:(e,l,a)=>{a.r(l),a.d(l,{default:()=>j});var t=a(59835),n=a(86970),o=a(60499),r=a(61957),i=a(56559),s=a(28339),c=a(27712),u=a(24352),g=a(60567),d=a(44886),p=a(99619),m=a(33722),w=a(84193),v=a(77155),_=a(81150),f=a(24189);const y={class:"c-nft-page"},b={key:0,class:"c-nft-page__empty-inventory"},h={class:"c-nft-page__empty-title"},k={key:1,class:"c-nft-page__controls-container"},U={class:"c-nft-page__grid-toggles"},P={key:2},S={key:0,class:"c-nft-page__tiles-loading-container"},q={key:3},T={class:"text-center"},F={key:4},D={key:0,class:"c-nft-page__tiles-container"},A=["aria-label","onClick","onKeydown"],C={key:0,class:"o-text--paragraph-bold u-text--default-contrast"},N={class:"o-text--paragraph"},W=(0,t.aZ)({__name:"NftInventoryPage",setup(e){const l=(0,m.P)(),a=(0,w.useChainStore)(),W=(0,w.useAccountStore)(),Z=a.currentChain.settings;Z.checkAndWarnIndexerHealth();const x=(0,s.tv)(),H=(0,s.yj)(),{t:Y}=(0,c.QT)(),I="tile",z="list",K=localStorage.getItem("nftInventoryDisplayPreference")||I,E=[{name:"image",field:"image",label:"",align:"left"},{name:"name",field:"name",label:Y("global.name"),align:"left"},{name:"id",field:"id",label:Y("global.id"),align:"left"},{name:"collection",field:"collection",label:Y("global.collection"),align:"left"},{name:"quantity",field:"quantity",label:Y("global.quantity"),align:"left"}],Q=[6,12,24,48,96],V=(0,o.iH)(!1),R=(0,o.iH)(!1),j=(0,o.iH)(K===I),M=(0,o.iH)(""),O=(0,o.iH)(""),X=(0,o.iH)(null),$=(0,o.iH)({page:1,rowsPerPage:12,rowsNumber:0}),{__user_filter:L}=(0,i.Jk)(l),B=(0,t.Fl)((()=>W.loggedAccount?.account)),J=(0,t.Fl)((()=>l.loggedInventoryLoading||!V.value||Boolean(!ae.value.length&&ee.value.length))),G=(0,t.Fl)((()=>V.value&&ae.value.length)),ee=(0,t.Fl)((()=>V.value?l.getUserFilteredInventory(w.CURRENT_CONTEXT):[])),le=(0,t.Fl)((()=>{const{page:e,rowsPerPage:l}=$.value,a=1===e?0:(e-1)*l,t=a+l;return ee.value.slice(a,t)})),ae=(0,t.Fl)((()=>l.getCollectionList(w.CURRENT_CONTEXT)||[])),te=(0,t.Fl)((()=>ae.value.map((e=>e.name)))),ne=(0,t.Fl)((()=>j.value?[]:le.value.map((e=>({image:e.imgSrc,name:(0,_.aF)(e.name,35),isAudio:!!e.audioSrc,isVideo:!!e.videoSrc,id:e.id,collectionName:e.contractPrettyName||e.contractAddress,collectionAddress:e.contractAddress,quantity:e instanceof v.Kd?e.owners[B.value]??0:1}))))),oe=(0,t.Fl)((()=>(M.value||O.value)&&!le.value.length));function re(e){const l=Z.getExplorerUrl();return`${l}/address/${e}`}function ie({isAudio:e,isVideo:l}){return e?"o_headphones":l?"o_movie":"o_image_not_supported"}function se({collectionAddress:e,id:l}){x.push({name:"evm-nft-details",query:{contract:e,id:l}})}function ce(e){return le.value.find((l=>l.id===e.id&&l.contractAddress===e.collectionAddress))}let ue;(0,t.YP)(G,(e=>{if(e){const{rowsPerPage:e,page:a,collection:t,search:n}=H.query;let o=12,r=1;e&&Q.includes(+(e??12))&&(o=+(e??12));const i=a&&o*(+a-1)<ee.value.length;if(i&&(r=+a),$.value={rowsNumber:ee.value.length,page:r,rowsPerPage:o},n&&(O.value=n),t){const e=ae.value.find((e=>e.contract===t))?.name;M.value=e||(0,_.FP)(t)}l.setUserFilter({collection:t??"",searchTerm:n??""}),R.value=!0}})),(0,t.YP)(B,((e,a)=>{const t=e!==a,n=void 0===a;e&&(t||n)&&l.updateNFTsForAccount(w.CURRENT_CONTEXT,e).finally((()=>{V.value=!0}))}),{immediate:!0}),(0,t.YP)(j,(e=>{localStorage.setItem("nftInventoryDisplayPreference",e?I:z)})),(0,t.YP)($,(({rowsPerPage:e,page:l})=>{x.replace({name:"evm-nft-inventory",query:{...H.query,rowsPerPage:e,page:l}})})),(0,t.YP)(H,(e=>{if("evm-nft-inventory"===e.name){if(e.query.collection){const l=ae.value.find((l=>l.contract===e.query.collection))?.name;M.value=l||(0,_.FP)(e.query.collection)}else M.value="";O.value=e.query.search??"",$.value={page:+(e.query.page??1),rowsPerPage:+(e.query.rowsPerPage??12),rowsNumber:ee.value.length}}})),(0,t.YP)(L,(e=>{let l=$.value.page;R.value&&(e.collection||e.searchTerm)&&(l=1),x.replace({name:"evm-nft-inventory",query:{rowsPerPage:$.value.rowsPerPage,page:l,collection:e.collection,search:e.searchTerm}})})),(0,t.YP)(M,(e=>{const a=ae.value.find((l=>l.name===e||l.contract===e))?.contract||"",t=l.getUserFilter;t.collection!==a&&l.setUserFilter({...t,collection:a})})),(0,t.YP)(O,(e=>{const a=l.getUserFilter;a.searchTerm!==e&&l.setUserFilter({...a,searchTerm:e})}));const ge=6e4;return(0,t.bv)((async()=>{ue=setInterval((async()=>{W.loggedAccount&&await l.updateNFTsForAccount(w.CURRENT_CONTEXT,W.loggedAccount.account)}),ge)})),(0,t.Ah)((()=>{clearInterval(ue)})),(e,l)=>{const a=(0,t.up)("q-select"),i=(0,t.up)("q-input"),s=(0,t.up)("q-icon"),c=(0,t.up)("q-skeleton"),m=(0,t.up)("q-th"),w=(0,t.up)("q-tr"),W=(0,t.up)("q-td"),Z=(0,t.up)("q-table");return(0,t.wg)(),(0,t.j4)(u.Z,null,{header:(0,t.w5)((()=>[(0,t._)("h1",null,(0,n.zw)((0,o.SU)(Y)("evm_wallet.inventory")),1)])),default:(0,t.w5)((()=>[(0,t._)("div",y,[0!==(0,o.SU)(ee).length||(0,o.SU)(J)||(0,o.SU)(oe)?(0,o.SU)(ee).length||(0,o.SU)(J)||(0,o.SU)(oe)?((0,t.wg)(),(0,t.iD)("div",k,[(0,t.Wm)(a,{modelValue:M.value,"onUpdate:modelValue":l[0]||(l[0]=e=>M.value=e),options:(0,o.SU)(te),disable:(0,o.SU)(J),label:(0,o.SU)(Y)("global.collection"),outlined:"",clearable:"",class:"c-nft-page__input"},null,8,["modelValue","options","disable","label"]),(0,t.Wm)(i,{ref_key:"searchbar",ref:X,modelValue:O.value,"onUpdate:modelValue":l[1]||(l[1]=e=>O.value=e),disable:(0,o.SU)(J),label:(0,o.SU)(Y)("global.search"),outlined:"",clearable:"",class:"c-nft-page__input"},null,8,["modelValue","disable","label"]),(0,t._)("div",U,[(0,t.Wm)(s,{size:"sm",name:"o_format_list_bulleted",color:j.value?"":"primary",class:"cursor-pointer",tabindex:"0",role:"button","aria-label":(0,o.SU)(Y)("nft.show_as_list_label"),onClick:l[2]||(l[2]=e=>j.value=!1),onKeydown:l[3]||(l[3]=(0,r.D2)((0,r.iM)((e=>j.value=!1),["prevent"]),["space","enter"]))},null,8,["color","aria-label"]),(0,t.Wm)(s,{size:"sm",name:"o_grid_view",color:j.value?"primary":"",class:"cursor-pointer",tabindex:"0",role:"button","aria-label":(0,o.SU)(Y)("nft.show_as_tiles_label"),onClick:l[4]||(l[4]=e=>j.value=!0),onKeydown:l[5]||(l[5]=(0,r.D2)((0,r.iM)((e=>j.value=!0),["prevent"]),["space","enter"]))},null,8,["color","aria-label"])])])):(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("div",b,[(0,t._)("h2",h,(0,n.zw)((0,o.SU)(Y)("nft.empty_collection_title")),1)])),(0,o.SU)(J)?((0,t.wg)(),(0,t.iD)("div",P,[j.value?((0,t.wg)(),(0,t.iD)("div",S,[((0,t.wg)(),(0,t.iD)(t.HY,null,(0,t.Ko)(25,(e=>(0,t.Wm)(c,{key:`loading-tile-${e}`,type:"rect",class:"c-nft-page__tile-skeleton"}))),64))])):((0,t.wg)(),(0,t.iD)(t.HY,{key:1},(0,t.Ko)(25,(e=>(0,t._)("div",{key:`loading-row-${e}`,class:"c-nft-page__list-loading-container"},[(0,t.Wm)(c,{type:"rect",class:"c-nft-page__list-skeleton-icon"}),(0,t.Wm)(c,{type:"rect",class:"c-nft-page__list-skeleton-row"})]))),64))])):(0,o.SU)(oe)?((0,t.wg)(),(0,t.iD)("div",q,[(0,t._)("h4",T,(0,n.zw)((0,o.SU)(Y)("global.no_results")),1)])):(0,o.SU)(ee).length?((0,t.wg)(),(0,t.iD)("div",F,[j.value?((0,t.wg)(),(0,t.iD)("div",D,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,o.SU)(le),(e=>((0,t.wg)(),(0,t.j4)(g.Z,{key:e.key,nft:e,quantity:e instanceof(0,o.SU)(v.Kd)?e.owners[(0,o.SU)(B)]??0:1},null,8,["nft","quantity"])))),128))])):((0,t.wg)(),(0,t.j4)(Z,{key:1,columns:E,rows:(0,o.SU)(ne),pagination:{rowsPerPage:0},"hide-pagination":"",flat:""},{header:(0,t.w5)((e=>[(0,t.Wm)(w,{props:e},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.j4)(m,{key:l.name,props:e,class:"o-text--paragraph u-text--default-contrast"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,t.w5)((e=>[(0,t.Wm)(w,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{key:"image",props:e},{default:(0,t.w5)((()=>[(0,t._)("div",{class:"c-nft-page__table-image-container",role:"link",tabindex:"0","aria-label":(0,o.SU)(Y)("nft.go_to_detail_page_label"),onClick:l=>se(e.row),onKeydown:(0,r.D2)((0,r.iM)((l=>se(e.row)),["prevent"]),["space","enter"])},[e.row.image||e.row.isVideo?((0,t.wg)(),(0,t.j4)(d.Z,{key:0,nft:ce(e.row),previewMode:!1,tileMode:!1},null,8,["nft"])):((0,t.wg)(),(0,t.j4)(s,{key:1,name:ie(e.row),size:"md",color:"grey-7"},null,8,["name"]))],40,A)])),_:2},1032,["props"]),(0,t.Wm)(W,{key:"name",props:e},{default:(0,t.w5)((()=>[e.row.name?((0,t.wg)(),(0,t.iD)("span",C,(0,n.zw)(e.row.name),1)):((0,t.wg)(),(0,t.iD)(t.HY,{key:1},[(0,t.Uk)((0,n.zw)((0,o.SU)(Y)("nft.name_missing")),1)],64))])),_:2},1032,["props"]),(0,t.Wm)(W,{key:"id",props:e},{default:(0,t.w5)((()=>[(0,t._)("span",N,(0,n.zw)((0,o.SU)(_.aF)(e.row.id)),1)])),_:2},1032,["props"]),(0,t.Wm)(W,{key:"collection",props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(p.Z,{text:e.row.collectionName,url:re(e.row.collectionAddress)},null,8,["text","url"])])),_:2},1032,["props"]),(0,t.Wm)(W,{key:"quantity",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.row.quantity),1)])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["rows"])),(0,t.Wm)(f.Z,{class:"q-mt-lg",pagination:$.value,"rows-per-page-options":Q,"row-label":"nft.collectibles_per_page",onPaginationUpdated:l[6]||(l[6]=e=>$.value=e)},null,8,["pagination","row-label"])])):(0,t.kq)("",!0)])])),_:1})}}});var Z=a(4581),x=a(66611),H=a(22857),Y=a(57133),I=a(31746),z=a(31233),K=a(21682),E=a(67220),Q=a(69984),V=a.n(Q);const R=W,j=R;V()(W,"components",{QSelect:Z.Z,QInput:x.Z,QIcon:H.Z,QSkeleton:Y.ZP,QTable:I.Z,QTr:z.Z,QTh:K.Z,QTd:E.Z})}}]);